# 桌面端小说阅读器 PRD

## 1. 产品背景与目标

### 1.1 背景
随着电子阅读的普及，用户在桌面端（Windows / macOS / Linux）进行长时间小说阅读的需求逐渐增加。现有阅读器要么功能复杂、干扰信息多，要么对沉浸式阅读支持不足，难以满足“专注阅读”的核心诉求。

### 1.2 产品目标
打造一款**轻量、专注、可沉浸**的桌面端小说阅读器，核心目标包括：
- 提供纯粹的阅读体验，最大限度减少界面干扰
- 支持本地小说文件导入，保护用户隐私
- 提供高度可定制的阅读环境（背景、行数等）
- 通过沉浸式阅读模式满足深度阅读场景

### 1.3 目标用户
- 长时间阅读网络小说 / 电子书的用户
- 程序员、学生等需要专注阅读的群体
- 对阅读界面简洁度要求较高的用户

---

## 2. 使用场景

1. 用户在本地导入 TXT 小说文件，在电脑上进行长时间阅读
2. 夜间阅读时，通过调整背景颜色减少视觉疲劳
3. 专注阅读时，开启沉浸式模式，屏蔽所有非必要 UI
4. 使用键盘或鼠标滚轮进行无打断阅读

---

## 3. 功能需求

### 3.1 小说文件导入

**功能描述**  
支持用户导入本地小说文件并进行阅读。

**功能点**
- 支持文件格式：TXT（V1 版本）
- 导入方式：
    - 菜单栏选择文件导入
    - 拖拽文件至阅读器窗口
- 文件导入后自动加载内容
- 支持重新导入/切换文件

**非功能要求**
- 不上传文件至云端，所有内容仅本地处理

---

### 3.2 基础阅读功能

**功能描述**  
提供基础的小说阅读能力。

**功能点**
- 文本自动排版
- 支持上下滚动阅读
- 阅读进度自动记录（本地存储）
- 重新打开文件时定位至上次阅读位置

---

### 3.3 背景与阅读样式设置

**功能描述**  
允许用户自定义阅读环境，满足不同光线与审美偏好。

**可配置项**
- 背景颜色
    - 预设颜色：白色 / 米黄色 / 深色 / 护眼绿
    - 自定义颜色：通过取色器（Color Picker）选择任意颜色
- 字体大小
- 行高
- 字体类型（系统字体）

**交互说明**
- 设置面板仅在非沉浸模式下可见
- 点击“背景颜色”配置项：
    - 可直接选择预设色块
    - 或唤起系统取色器，吸取屏幕任意颜色并即时生效
- 所有样式配置需本地持久化保存

---

### 3.4 沉浸式阅读模式（核心功能）

**功能描述**  
提供极致专注的阅读体验，仅显示正文内容。

**进入方式**
- 快捷键（如：F11 / Cmd + Shift + I）
- 菜单按钮

**功能规则**
- 进入沉浸式模式后：
    - 隐藏标题栏、菜单栏、工具栏
    - 隐藏滚动条
    - 页面仅显示小说正文
- 禁止任何弹窗、提示信息显示

**窗口尺寸规则**
- 用户可在设置中配置“每屏显示行数”
- 开启沉浸式模式后：
    - 窗口高度 = 字体行高 × 行数
    - 窗口宽度保持当前宽度或使用默认阅读宽度

---

### 3.5 阅读操作方式

**滚动方式**
- 鼠标滚轮上下滚动
- 触控板自然滚动

**键盘操作**
- ↑ / ↓：逐行滚动
- PageUp / PageDown：分页滚动
- Esc：退出沉浸式模式

---

## 4. 非功能性需求

### 4.1 性能要求
- 支持 1MB ~ 5MB TXT 文件流畅加载
- 滚动无明显卡顿

### 4.2 兼容性
- 操作系统：
    - Windows 10+
    - macOS 12+
- 屏幕分辨率：支持 1080p 及以上

### 4.3 可用性
- 启动时间 ≤ 3 秒
- 核心功能无需登录即可使用

---

## 5. 交互与界面设计原则

- **极简主义**：默认界面只保留必要元素
- **沉浸优先**：沉浸式模式是核心体验
- **键盘友好**：常用操作尽量提供快捷键
- **视觉舒适**：颜色、字体以长时间阅读为优先

---

## 6. 技术实现方案（Electron 工程视角）

### 6.1 客户端技术选型（确定方案）

- 桌面端框架：**Electron（确定方案）**
- 前端框架：**React**
- 样式方案：**Tailwind CSS**
- 渲染引擎：Chromium
- 主进程语言：Node.js
- 状态管理：Zustand

**选型说明**
- Electron 对窗口控制、快捷键、文件系统支持成熟稳定
- Tailwind CSS 适合快速构建极简、可控的阅读样式系统
- React + Tailwind 组合利于样式与状态强解耦

### 6.2 文件导入与解析

- 使用 Electron `dialog.showOpenDialog` 调用系统文件选择器
- 主进程通过 `fs` 模块读取本地 TXT 文件
- 使用 UTF-8 编码解析文本内容
- 对大文件采用流式读取或分段读取，避免阻塞渲染进程

### 6.3 文本渲染与性能优化

- 渲染进程使用虚拟滚动（如 react-window / react-virtual）
- 文本按段落拆分为最小渲染单元
- 滚动时仅更新可视区域内容，避免整体重绘

### 6.4 沉浸式阅读模式实现

- 使用 `BrowserWindow` 无边框模式（`frame: false`）
- 隐藏菜单栏与窗口控制按钮
- 渲染进程进入纯正文模式，仅保留文本区域

**窗口尺寸计算逻辑**
- 行高 = 字体大小 × 行高系数
- 窗口高度 = 行高 × 用户配置行数
- 通过 `BrowserWindow.setSize` 动态调整窗口高度

### 6.5 输入与交互

- 渲染进程监听键盘事件（↑ ↓ PageUp PageDown Esc）
- 使用 Electron `globalShortcut`（可选）注册全局快捷键
- 鼠标滚轮与触控板统一映射为滚动行为

### 6.6 样式与主题系统（Tailwind）

- 使用 Tailwind CSS 构建阅读样式体系
- 背景色、字体大小、行高通过 Tailwind utility + CSS 变量组合实现
- 支持系统原生 Color Picker，选取颜色后动态写入 CSS 变量

### 6.7 本地数据存储

- 存储内容：
    - 最近打开文件路径
    - 阅读进度（滚动位置或字符偏移）
    - 阅读样式配置
- 存储方式：
    - 使用 Electron `app.getPath('userData')`
    - JSON 文件持久化存储

---

